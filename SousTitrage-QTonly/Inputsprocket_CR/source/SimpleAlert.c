/* *  © 1997-2000 Metrowerks Corp. * *  Questions and comments to: *       <mailto:support@metrowerks.com> *       <http://www.metrowerks.com/> */#include <Dialogs.h>#include <Fonts.h>#include <MacWindows.h>#include <Menus.h>#include <QuickDraw.h>#include <TextEdit.h>#include <TextEdit.h>#include "ISp_Sample.h"#include "IPsCR.h"#include <stdio.h>void PPCDispatch_init(void);enum{	kAlertID = 128};static Handle	ISpCRH;static short	gAcceleratedResourceLoaded;static void Initialize(void){#if !TARGET_API_MAC_CARBON	InitGraf(&qd.thePort);	InitFonts();	InitWindows();	InitMenus();	TEInit();	InitDialogs(nil);#endif	InitCursor();}void main(void){long red,key;//NumVersion res;short end=0;Input_GameState igs;EventRecord	theEvent;	Initialize();		//NoteAlert(kAlertID, NULL);	// test input sprocket	PPCDispatch_init();	// on initialise le joystick.	key=PPCDispatch_ISpCR(1,0,0);	igs.button=0;// loop de gestion	do{	WaitNextEvent(everyEvent, &theEvent, 0, nil);	if (theEvent.what==mouseDown) end =true;		red=PPCDispatch_ISpCR(2,key,&igs);		/*	printf("throttleInput: %ld, ",(long)igs.throttleInput);	printf("yawInput: %ld, ",(long)igs.yawInput);	printf("pitch: %ld, ",(long)igs.pitchInput);	printf("rollInput: %ld \n",(long)igs.rollInput);	*/	printf("throttleInput: %ld yawInput: %ld pitch: %ld rollInput: %ld, button %lx \n",(long) igs.throttleInput,(long)igs.yawInput,(long)igs.pitchInput,(long)igs.rollInput,(long)igs.button);		}while(end != true);// on arrte de sprocket	red=PPCDispatch_ISpCR(3,key,0);}void PPCDispatch_init(void){	OSErr 		err;	long		response;	short		myBit;	Boolean		gHasCFM;		gAcceleratedResourceLoaded=false; // par defaut	ISpCRH=nil;	gHasCFM=0;	// sommes nous sur une machine 68K ou PPC ?	Gestalt('cput',&response);		if ((response&0xFFF) >= 0x101) { // ppc ?		err = Gestalt(gestaltCFMAttr, &response);		myBit = gestaltCFMPresent;		gHasCFM = BitTst (&response, 31-myBit);	}		if (gHasCFM){  // si machine PPC		ISpCRH = Get1Resource('MWCW', 132 );		if (ISpCRH) 	HLock(ISpCRH);				if (ISpCRH)			gAcceleratedResourceLoaded=true;				}// si machine PPC} //PPCDispatch_initlong PPCDispatch_ISpCR(short code,long param,Input_GameState* igs){ISpCR_UPP	ISpCRProc;			long		ret=-1;				if (ISpCRH){ // dispacht si resource pas loader		ISpCRProc = (ISpCR_UPP)*ISpCRH;		ret= ISpCR_Proc(ISpCRProc,code,param,igs);	} 	return ret;	} //