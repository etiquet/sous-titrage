#include "All.h"pascal	void SpecialFrameRect(Rect *rect,Boolean Enfonce);typedef struct sliderstruct{short	min;short	max;short	value;short	increment;Rect	bounds;}sliderstruct,*sliderstructPtr,**sliderstructHandle;pascal sliderstructHandle GetNewSlider(short minvalue,			short maxvalue,short value,short increment,Rect *rect);pascal void DrawSlider(sliderstructHandle slider);	pascal short DoSliderFollow(sliderstructHandle slider);pascal sliderstructHandle GetNewSlider(short minvalue,			short maxvalue,short value,short increment,Rect *rect){			sliderstructHandle slider;					slider=(sliderstructHandle)NewHandle(sizeof(sliderstruct));		if (slider){		(**slider).min=minvalue;		(**slider).max=maxvalue;		(**slider).value=value;		(**slider).increment=increment;		(**slider).bounds=*rect;		}		return	slider;}pascal void DrawSlider(sliderstructHandle slider){CIconHandle	icon;Rect	rect;RGBColor	saveBackColor,color;	long	a,b;Str255	string;			rect.left=(**slider).bounds.left;		rect.right=(**slider).bounds.right;		rect.top=((**slider).bounds.top+(**slider).bounds.bottom)/2-1;		rect.bottom=rect.top+2;		rect.top-=8;		rect.bottom+=8;					EraseRect(&(**slider).bounds);				rect.top+=8;		rect.bottom-=8;					// on dessine le contour blanc				GetForeColor(&saveBackColor);					color.red=0xffff;				color.green=0xffff;				color.blue=0xffff;				RGBForeColor(&color);				MoveTo(rect.left,rect.bottom);				LineTo(rect.right,rect.bottom);				LineTo(rect.right,rect.top);				RGBForeColor(&saveBackColor);			// on dessine le contour gris				GetForeColor(&saveBackColor);					color.red=0x0000;				color.green=0x0000;				color.blue=0x0000;				RGBForeColor(&color);				MoveTo(rect.left,rect.bottom);				LineTo(rect.left,rect.top);				LineTo(rect.right,rect.top);				RGBForeColor(&saveBackColor);				// on calcule la position du slider			a=(long)(**slider).bounds.right-(**slider).bounds.left-15;			a=a*((**slider).value-(**slider).min);			a=a/((long)(**slider).max-(**slider).min);			b=(**slider).max-(**slider).min;// on effectue l'incrément					a=(a/b)*b;		// on dessine le curseur			rect.left=(**slider).bounds.left+a+5;			rect.right=rect.left+10;			rect.top=((**slider).bounds.top+(**slider).bounds.bottom)/2-7;			rect.bottom=rect.top+13;						icon=GetCIcon(155);			if (icon) {				PlotCIcon(&rect,icon);				DisposeCIcon(icon);			}			 NumToString((long)(**slider).value,&string);			 MoveTo((**slider).bounds.right+8,(**slider).bounds.top+12);			 TextMode(srcCopy);			 if (string[0]==1) {						 	string[0]=2;						 	string[2]=string[1];						 	string[1]=48;			 }						 DrawString(&string);}pascal short DoSliderFollow(sliderstructHandle slider){Point		pt;RgnHandle	rgn;GrafPtr		port;long a,b,c;		Rect rect;	CIconHandle	icon;RGBColor	saveBackColor,color;	Str255	string;			rgn=NewRgn();			GetPort(&port);						CopyRgn(port->clipRgn,rgn);			GetMouse(&pt);	// on calcule la nouvelle valeur			a=pt.h;			if (a<(**slider).bounds.left+5) a=(long)(**slider).bounds.left+5;			if (a>(**slider).bounds.right-10) a=(long)(**slider).bounds.right-10;							a=a-(long)(**slider).bounds.left+5;			a=a*((long)(**slider).max-(**slider).min);			a=a/((long)(**slider).bounds.right-(**slider).bounds.left-15);			b=a+(**slider).min;// on efface l'ancien 			if (b!=(**slider).value) {				a=(long)(**slider).bounds.right-(**slider).bounds.left-15;				a=a*((**slider).value-(**slider).min);				a=a/((long)(**slider).max-(**slider).min);				c=(**slider).max-(**slider).min;	// on effectue l'incrément						a=(a/c)*c;		// on dessine le curseur			rect.left=(**slider).bounds.left+a+5;			rect.right=rect.left+10;			rect.top=((**slider).bounds.top+(**slider).bounds.bottom)/2-7;			rect.bottom=rect.top+13;				RectRgn(port->clipRgn,&rect);				rect.left=(**slider).bounds.left;				rect.right=(**slider).bounds.right;				rect.top=((**slider).bounds.top+(**slider).bounds.bottom)/2-1;				rect.bottom=rect.top+2;				rect.top-=8;				rect.bottom+=8;							EraseRect(&(**slider).bounds);						rect.top+=8;				rect.bottom-=8;					// on dessine le contour blanc				GetForeColor(&saveBackColor);					color.red=0xffff;				color.green=0xffff;				color.blue=0xffff;				RGBForeColor(&color);				MoveTo(rect.left,rect.bottom);				LineTo(rect.right,rect.bottom);				LineTo(rect.right,rect.top);				RGBForeColor(&saveBackColor);			// on dessine le contour gris				GetForeColor(&saveBackColor);					color.red=0x0000;				color.green=0x0000;				color.blue=0x0000;				RGBForeColor(&color);				MoveTo(rect.left,rect.bottom);				LineTo(rect.left,rect.top);				LineTo(rect.right,rect.top);				RGBForeColor(&saveBackColor);						CopyRgn(rgn,port->clipRgn);				DisposeRgn(rgn);			}			(**slider).value=b;// on calcule la position du slider			a=(long)(**slider).bounds.right-(**slider).bounds.left-15;			a=a*((**slider).value-(**slider).min);			a=a/((long)(**slider).max-(**slider).min);			b=(**slider).max-(**slider).min;// on effectue l'incrément					a=(a/b)*b;		// on dessine le curseur			rect.left=(**slider).bounds.left+a+5;			rect.right=rect.left+10;			rect.top=((**slider).bounds.top+(**slider).bounds.bottom)/2-7;			rect.bottom=rect.top+13;						icon=GetCIcon(155);			if (icon) {				PlotCIcon(&rect,icon);				DisposeCIcon(icon);			}			 NumToString((long)(**slider).value,&string);			 MoveTo((**slider).bounds.right+8,(**slider).bounds.top+12);			 TextMode(srcCopy);			 if (string[0]==1) {						 	string[0]=2;						 	string[2]=string[1];						 	string[1]=48;			 }						 DrawString(&string);			return b;}pascal	void SpecialFrameRect(Rect *rect,Boolean Enfonce){	RGBColor	saveBackColor,color;									PenSize(1,1);								if (Enfonce) { //relief  enfoncé				 // on dessine le contour gris clair clair					 GetForeColor(&saveBackColor);						 color.red=0xffff;					 color.green=0xffff;					 color.blue=0xffff;					 RGBForeColor(&color);					 MoveTo((*rect).left,(*rect).bottom-1);					 LineTo((*rect).right-1,(*rect).bottom-1);					 LineTo((*rect).right-1,(*rect).top);					 RGBForeColor(&saveBackColor);	 				 // on dessine le contour gris sombre sombre					 GetForeColor(&saveBackColor);						 color.red=0x2000;					 color.green=0x2000;					 color.blue=0x2000;					 RGBForeColor(&color);					 MoveTo((*rect).left,(*rect).bottom-1);					 LineTo((*rect).left,(*rect).top);					 LineTo((*rect).right-1,(*rect).top);					 RGBForeColor(&saveBackColor);									 PenNormal();					 					 InsetRect(rect,1,1);					 				 // on dessine le contour gris clair					 GetForeColor(&saveBackColor);						 color.red=0xdfff;					 color.green=0xdfff;					 color.blue=0xdfff;					 RGBForeColor(&color);					 MoveTo((*rect).left,(*rect).bottom-1);					 LineTo((*rect).right-1,(*rect).bottom-1);					 LineTo((*rect).right-1,(*rect).top);					 RGBForeColor(&saveBackColor);	 				 // on dessine le contour gris sombre					 GetForeColor(&saveBackColor);						 color.red=0x4000;					 color.green=0x4000;					 color.blue=0x4000;					 RGBForeColor(&color);					 MoveTo((*rect).left,(*rect).bottom-1);					 LineTo((*rect).left,(*rect).top);					 LineTo((*rect).right-1,(*rect).top);					 RGBForeColor(&saveBackColor);									 PenNormal();					 				} else {								 // on dessine le contour gris clair								// on dessine le contour gris sombre sombre					 GetForeColor(&saveBackColor);						 color.red=0x4000;					 color.green=0x4000;					 color.blue=0x4000;					 RGBForeColor(&color);					 MoveTo((*rect).left,(*rect).bottom-1);					 LineTo((*rect).right-1,(*rect).bottom-1);					 LineTo((*rect).right-1,(*rect).top);					 RGBForeColor(&saveBackColor);	 				 // on dessine le contour gris clair clair					 GetForeColor(&saveBackColor);						 color.red=0xEF00;					 color.green=0xEF00;					 color.blue=0xEF00;					 RGBForeColor(&color);					 MoveTo((*rect).left,(*rect).bottom-1);					 LineTo((*rect).left,(*rect).top);					 LineTo((*rect).right-1,(*rect).top);					 RGBForeColor(&saveBackColor);									 PenNormal();					 					 InsetRect(rect,1,1);					 					// gris sombre 										 GetForeColor(&saveBackColor);						 color.red=0x6000;					 color.green=0x6000;					 color.blue=0x6000;					 RGBForeColor(&color);					 MoveTo((*rect).left,(*rect).bottom-1);					 LineTo((*rect).right-1,(*rect).bottom-1);					 LineTo((*rect).right-1,(*rect).top);					 RGBForeColor(&saveBackColor);	 				 // on dessine le contour gris clair				 					 GetForeColor(&saveBackColor);						 color.red=0xCfff;					 color.green=0xCfff;					 color.blue=0xCfff;					 RGBForeColor(&color);					 MoveTo((*rect).left,(*rect).bottom-1);					 LineTo((*rect).left,(*rect).top);					 LineTo((*rect).right-1,(*rect).top);					 RGBForeColor(&saveBackColor);									 PenNormal();				}				} //SpecialFrameRect